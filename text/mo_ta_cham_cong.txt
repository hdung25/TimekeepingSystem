MÔ TẢ CHI TIẾT CHỨC NĂNG CHẤM CÔNG VÀ CÁC TRƯỜNG HỢP XỬ LÝ
============================================================

Tài liệu này mô tả chi tiết logic hoạt động của hệ thống chấm công hiện tại (Phiên bản V2).

PHẦN 1: QUY TRÌNH CHUẨN (HAPPY PATH)
------------------------------------

1. Vào Ca (Check-in)
   - Điều kiện: Địa chỉ IP người dùng trùng khớp IP công ty (Cấu hình trong Hệ Thống).
   - Hành động: Bấm nút "VÀO CA".
   - Kết quả: Hệ thống tạo Session mới. Trạng thái chuyển sang "ĐANG TRONG CA".

2. Ra Ca (Check-out)
   - Điều kiện: Đang có ca mở.
   - Hành động: Bấm nút "RA CA".
   - Kết quả: Hệ thống chốt giờ kết thúc. Tính toán thời gian làm việc.

PHẦN 2: XỬ LÝ CÁC TRƯỜNG HỢP NGOẠI LỆ (EXCEPTION HANDLING)
---------------------------------------------------------

1. Quên Ra Ca (Forgot Check-out) & Ca Đêm
   - Logic: Khi tính lương, hệ thống kiểm tra các Session chưa đóng (Open Sessions).
   - Nếu thời gian hiện tại đã vượt quá giờ kết thúc lớp học (+30 phút):
     -> Hệ thống tự động đóng ca ảo.
     -> Giờ ra = Giờ kết thúc của lớp học (trong Lịch).
     -> Thẻ hiển thị màu Cam (Cảnh báo).
   - Lợi ích: Đảm bảo tính lương tự động cho ca đêm hoặc người quên bấm nút.

2. Quên Check-in (Quên Vào Ca)
   - Logic: Không có dữ liệu Check-in -> Không có Session.
   - Kết quả: Hệ thống hiển thị "Vắng" (Thẻ Xám) tại các khung giờ có lịch dạy.
   - Khắc phục: Admin phải thêm thủ công (Manual Entry) thông qua nút ➕ trên bảng công.

3. Đi Trễ (Late Arrival)
   - Logic: So sánh Giờ Check-in thực tế với Giờ Bắt đầu của Lớp.
   - Nếu Trễ: Tính thời gian làm việc thực tế còn lại. Thẻ màu Cam.
   - Nếu Đúng giờ (hoặc sớm): Tính 100% thời gian lớp học.

PHẦN 3: TÍNH LƯƠNG & ĐÁNH GIÁ
----------------------------------

1. Công thức lương (Cơ bản):
   - Tổng Lương = (Tổng Giờ Làm x Lương Giờ) + Thưởng - Phạt.
   - (Hiện tại hệ thống tập trung hiển thị Tổng Giờ Làm chính xác).

2. Đánh Giá (KPI):
   - Admin nhập liệu trực tiếp trên bảng lương.
   - Dữ liệu đánh giá được lưu lại theo Tháng và Nhân Viên.

KHUYẾN NGHỊ VẬN HÀNH
--------------------
- Nhân viên NÊN bấm "Nhận Lớp" đầy đủ để hệ thống có căn cứ tính lương khi quên Check-out.
- Admin nên kiểm tra IP định kỳ nếu thấy nhân viên Check-in từ xa.
